<!DOCTYPE html><html><head><meta charset='utf-8'><meta http-equiv='Access-Control-Allow-Origin' content='*'><meta http-equiv='Access-Control-Allow-Credentials' content='true'><script src='https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/GameElements_20190131/gameelements.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/holistic_20201012/holistic_video.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/holistic_20201012/holistic.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/MQTT_20220324/mqtt.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/spreadsheetsql.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/loader.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/TextToSpeech_20220729/texttospeech.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpeechRecognition_20220729/speechrecognition.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/line_20220729/line.js'></script></head><body><script>const delay=(seconds)=>{return new Promise((resolve)=>{setTimeout(resolve,seconds*1000);});};const main=async()=>{
var _E8_A8_82_E9_96_B1_E4_B8_BB_E9_A1_8C, _E8_AA_9E_E9_9F_B3, _E6_96_87_E5_AD_97, _E8_A9_A6_E7_AE_97_E8_A1_A8_E4_BB_A3_E7_A2_BC, _E5_B7_A5_E4_BD_9C_E8_A1_A8_E5_90_8D_E7_A8_B1, _E9_A1_AF_E7_A4_BA_E6_AC_84_E4_BD_8D, SQL, _E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, _E5_AE_9A_E6_99_82_E6_8F_90_E9_86_92_E8_B3_87_E6_96_99, Line_E7_BE_A4_E7_B5_84_E6_AC_8A_E6_9D_96, _E6_99_82_E9_96_93, _E5_85_AC_E8_BB_8A_E8_BB_8A_E8_99_9F, _E5_AE_9A_E6_99_82_E6_8F_90_E9_86_92_E8_A8_88_E6_99_82_E5_99_A8, _E9_A1_AF_E7_A4_BA_E6_AC_84_E4_BD_8D_E5_90_8D_E7_A8_B1, _E6_9C_97_E8_AE_80_E8_AA_9E_E9_9F_B3, _E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C, _E9_96_8B_E9_97_9C_E7_8B_80_E6_85_8B, _E5_82_B3_E9_80_81_E6_96_87_E5_AD_97_E5_B0_8D_E8_B1_A1, i, _E8_A9_A6_E7_AE_97_E8_A1_A8ID, _E6_9A_AB_E5_AD_98_E8_B3_87_E6_96_99, _E5_82_B3_E9_80_81_E6_96_87_E5_AD_97, Line_E5_AE_B6_E4_BA_BA_E6_AC_8A_E6_9D_96, Line_E6_AC_8A_E6_9D_96;

// 描述此函式...
function _E5_BD_B1_E5_83_8F_E8_BE_A8_E8_AD_98() {
  if ((_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('開'.toLowerCase())!=-1) || (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('啟'.toLowerCase())!=-1)) {
    holistic_recognitionFinish = async function() {
    holistic_state(0);
      if ((holistic_pose_position("16","y")) < (holistic_pose_position("8","y")) && (holistic_pose_position("15","y")) < (holistic_pose_position("7","y"))) {
        if (!(ttsSpeaking())) {
          linenotify_push_message(Line_E5_AE_B6_E4_BA_BA_E6_AC_8A_E6_9D_96,{'type':'text','text':'我有事請大家幫忙'});
        }
        _E8_AA_9E_E9_9F_B3_E6_9C_97_E8_AE_80(_E6_9C_97_E8_AE_80_E8_AA_9E_E9_9F_B3, '你舉雙手了，幫您通知大家。');
        _E7_AD_89_E5_BE_85_E6_9C_97_E8_AE_80_E5_AE_8C_E6_88_90();
      } else if ((holistic_pose_position("16","y")) < (holistic_pose_position("8","y")) || (holistic_pose_position("15","y")) < (holistic_pose_position("7","y"))) {
        if (!(ttsSpeaking())) {
          linenotify_push_message(Line_E6_AC_8A_E6_9D_96,{'type':'text','text':'我有事請你幫忙'});
        }
        _E8_AA_9E_E9_9F_B3_E6_9C_97_E8_AE_80(_E6_9C_97_E8_AE_80_E8_AA_9E_E9_9F_B3, '你舉手了，幫您通知主人幫忙。');
        _E7_AD_89_E5_BE_85_E6_9C_97_E8_AE_80_E5_AE_8C_E6_88_90();
      }

    holistic_state(1);};
    holistic_state(1);
    video_set('',"display",true);
  } else if ((_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('關'.toLowerCase())!=-1) || (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('停'.toLowerCase())!=-1)) {
    holistic_state(0);
  }
}

// 描述此函式...
function _E6_92_AD_E6_94_BE_E9_9F_B3_E6_A8_82() {
  if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('下'.toLowerCase())!=-1) {
    mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'music'+'='+'4')));
  } else if ((_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('一'.toLowerCase())!=-1) || (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('1'.toLowerCase())!=-1)) {
    mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'music'+'='+'1')));
  } else if ((_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('二'.toLowerCase())!=-1) || (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('2'.toLowerCase())!=-1)) {
    mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'music'+'='+'2')));
  } else if ((_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('三'.toLowerCase())!=-1) || (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('3'.toLowerCase())!=-1)) {
    mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'music'+'='+'3')));
  } else if ((_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('停'.toLowerCase())!=-1) || (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('關'.toLowerCase())!=-1)) {
    mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'music'+'='+'5')));
  } else if ((_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('繼'.toLowerCase())!=-1) || (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('開'.toLowerCase())!=-1)) {
    mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'music'+'='+'6')));
  }
}

// 描述此函式...
function _E6_99_BA_E6_85_A7_E6_8E_A7_E5_88_B6() {
  if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C == '外出模式') {
    mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'mode'+'='+'1')));
  } else if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C == '休閒模式') {
    mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'mode'+'='+'2')));
  } else if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C == '睡覺模式') {
    mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'mode'+'='+'3')));
  } else {
    if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('開'.toLowerCase())!=-1) {
      var _E9_96_8B_E9_97_9C_E7_8B_80_E6_85_8B = 1;
    } else if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('關'.toLowerCase())!=-1) {
      var _E9_96_8B_E9_97_9C_E7_8B_80_E6_85_8B = 0;
    }
    if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('客廳'.toLowerCase())!=-1) {
      mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'led'+'='+'1'+';'+_E9_96_8B_E9_97_9C_E7_8B_80_E6_85_8B)));
    } else if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('浴室'.toLowerCase())!=-1) {
      mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'led'+'='+'2'+';'+_E9_96_8B_E9_97_9C_E7_8B_80_E6_85_8B)));
    } else if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('房間'.toLowerCase())!=-1) {
      mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'led'+'='+'3'+';'+_E9_96_8B_E9_97_9C_E7_8B_80_E6_85_8B)));
    } else if ((_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('全'.toLowerCase())!=-1) || (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('所'.toLowerCase())!=-1)) {
      mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'led'+'='+'4'+';'+_E9_96_8B_E9_97_9C_E7_8B_80_E6_85_8B)));
    } else if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('門'.toLowerCase())!=-1) {
      mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'lock'+'='+_E9_96_8B_E9_97_9C_E7_8B_80_E6_85_8B)));
    } else if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('冷氣'.toLowerCase())!=-1) {
      mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String(('?'+'ac'+'='+_E9_96_8B_E9_97_9C_E7_8B_80_E6_85_8B)));
    }
  }
}

// 描述此函式...
function _E8_A6_96_E8_A8_8A_E5_82_B3_E9_80_81() {
  if ((_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('傳送'.toLowerCase())!=-1) && !(_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('不傳送'.toLowerCase())!=-1)) {
    var Line_E7_BE_A4_E7_B5_84_E6_AC_8A_E6_9D_96 = (spreadsheetsql_getData());
    var _E5_82_B3_E9_80_81_E6_96_87_E5_AD_97_E5_B0_8D_E8_B1_A1 = _E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.slice(0, (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.indexOf('傳送') + 1) - 1);
    var i_end = Line_E7_BE_A4_E7_B5_84_E6_AC_8A_E6_9D_96.length;
    var i_inc = 1;
    if (1 > i_end) {
      i_inc = -i_inc;
    }
    for (i = 1; i_inc >= 0 ? i <= i_end : i >= i_end; i += i_inc) {
      var _E6_9A_AB_E5_AD_98_E8_B3_87_E6_96_99 = Line_E7_BE_A4_E7_B5_84_E6_AC_8A_E6_9D_96[(i - 1)];
      if (_E6_9A_AB_E5_AD_98_E8_B3_87_E6_96_99[0] == _E5_82_B3_E9_80_81_E6_96_87_E5_AD_97_E5_B0_8D_E8_B1_A1) {
        linenotify_push_image((_E6_9A_AB_E5_AD_98_E8_B3_87_E6_96_99[1]),"gamevideo_","");
        _E8_AA_9E_E9_9F_B3_E6_9C_97_E8_AE_80(_E6_9C_97_E8_AE_80_E8_AA_9E_E9_9F_B3, 'Line影像已傳送');
      }
    }
  }
}

// 描述此函式...
function _E5_85_AC_E8_BB_8A_E6_99_82_E5_88_BB() {
  if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('近'.toLowerCase())!=-1) {
    _E6_99_82_E9_96_93 = setDatetime(0, 0, 0, 0, 0, 0);
    SQL_E6_9F_A5_E8_A9_A2(_E8_A9_A6_E7_AE_97_E8_A1_A8ID, '公車時刻', false, ['select  A,B where timeofday \'',getDatetime(_E6_99_82_E9_96_93, "hour"),':',getDatetime(_E6_99_82_E9_96_93, "minute"),':',getDatetime(_E6_99_82_E9_96_93, "second"),'\'<B and A=\'',_E5_85_AC_E8_BB_8A_E8_BB_8A_E8_99_9F,'\' order by B limit 1'].join(''));
  } else {
    _E5_85_AC_E8_BB_8A_E8_BB_8A_E8_99_9F = _E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C;
    SQL_E6_9F_A5_E8_A9_A2(_E8_A9_A6_E7_AE_97_E8_A1_A8ID, '公車時刻', false, ['select  A,B where A=\'',_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C,'\' order by B'].join(''));
  }
}

// 描述此函式...
function _E8_A1_8C_E4_BA_8B_E6_9B_86_E6_9F_A5_E8_A9_A2() {
  if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('今'.toLowerCase())!=-1) {
    _E6_99_82_E9_96_93 = setDatetime(0, 0, 0, 0, 0, 0);
    SQL_E6_9F_A5_E8_A9_A2(_E8_A9_A6_E7_AE_97_E8_A1_A8ID, '行事曆', true, ['select  A,D where date \'',getDatetime(_E6_99_82_E9_96_93, "year"),'-',getDatetime(_E6_99_82_E9_96_93, "month"),'-',getDatetime(_E6_99_82_E9_96_93, "day"),'\'=B or B is null'].join(''));
  } else if ((Recognition_final_get()).toLowerCase().indexOf('明'.toLowerCase())!=-1) {
    _E6_99_82_E9_96_93 = setDatetime(0, 0, 1, 0, 0, 0);
    SQL_E6_9F_A5_E8_A9_A2(_E8_A9_A6_E7_AE_97_E8_A1_A8ID, '行事曆', true, ['select  A,D where date \'',getDatetime(_E6_99_82_E9_96_93, "year"),'-',getDatetime(_E6_99_82_E9_96_93, "month"),'-',getDatetime(_E6_99_82_E9_96_93, "day"),'\'=B or B is null'].join(''));
  } else if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('近'.toLowerCase())!=-1) {
    _E6_99_82_E9_96_93 = setDatetime(0, 0, 0, 0, 0, 0);
    SQL_E6_9F_A5_E8_A9_A2(_E8_A9_A6_E7_AE_97_E8_A1_A8ID, '行事曆', true, ['select  A,D where timeofday \'',getDatetime(_E6_99_82_E9_96_93, "hour"),':',getDatetime(_E6_99_82_E9_96_93, "minute"),':',getDatetime(_E6_99_82_E9_96_93, "second"),'\'<C or B is null order by C limit 1'].join(''));
  }
}

// 描述此函式...
function _E5_AE_9A_E6_99_82_E6_8F_90_E9_86_92() {
  _E5_AE_9A_E6_99_82_E6_8F_90_E9_86_92_E8_B3_87_E6_96_99 = (spreadsheetsql_getData());
  _E5_AE_9A_E6_99_82_E6_8F_90_E9_86_92_E8_A8_88_E6_99_82_E5_99_A8 = setInterval(async function(){
    var i_end2 = _E5_AE_9A_E6_99_82_E6_8F_90_E9_86_92_E8_B3_87_E6_96_99.length;
    var i_inc2 = 1;
    if (1 > i_end2) {
      i_inc2 = -i_inc2;
    }
    for (i = 1; i_inc2 >= 0 ? i <= i_end2 : i >= i_end2; i += i_inc2) {
      var _E6_9A_AB_E5_AD_98_E8_B3_87_E6_96_99 = _E5_AE_9A_E6_99_82_E6_8F_90_E9_86_92_E8_B3_87_E6_96_99[(i - 1)];
      _E6_99_82_E9_96_93 = setDatetime(0, 0, 0, 0, 0, 0);
      if (_E6_9A_AB_E5_AD_98_E8_B3_87_E6_96_99[0] == (getDatetime(_E6_99_82_E9_96_93, "hour")) && _E6_9A_AB_E5_AD_98_E8_B3_87_E6_96_99[1] == (getDatetime(_E6_99_82_E9_96_93, "minute")) && _E6_9A_AB_E5_AD_98_E8_B3_87_E6_96_99[2] == (getDatetime(_E6_99_82_E9_96_93, "second"))) {
        _E8_AA_9E_E9_9F_B3_E6_9C_97_E8_AE_80(_E6_9C_97_E8_AE_80_E8_AA_9E_E9_9F_B3, _E6_9A_AB_E5_AD_98_E8_B3_87_E6_96_99[3]);
      }
    }
  },1000);
}

// 描述此函式...
async function _E8_AA_9E_E9_9F_B3_E6_9C_97_E8_AE_80(_E8_AA_9E_E9_9F_B3, _E6_96_87_E5_AD_97) {
  Recognition_switch(0);
  ttsSpeak(_E8_AA_9E_E9_9F_B3, _E6_96_87_E5_AD_97);
}

// 描述此函式...
function SQL_E6_9F_A5_E8_A9_A2(_E8_A9_A6_E7_AE_97_E8_A1_A8_E4_BB_A3_E7_A2_BC, _E5_B7_A5_E4_BD_9C_E8_A1_A8_E5_90_8D_E7_A8_B1, _E9_A1_AF_E7_A4_BA_E6_AC_84_E4_BD_8D, SQL) {
  spreadsheetsql_clearDataTable('');
  _E9_A1_AF_E7_A4_BA_E6_AC_84_E4_BD_8D_E5_90_8D_E7_A8_B1 = _E9_A1_AF_E7_A4_BA_E6_AC_84_E4_BD_8D;
  spreadsheetsql_settings(_E8_A9_A6_E7_AE_97_E8_A1_A8_E4_BB_A3_E7_A2_BC,_E5_B7_A5_E4_BD_9C_E8_A1_A8_E5_90_8D_E7_A8_B1);
  spreadsheetsql_executeSql(SQL);
}

// 描述此函式...
function _E8_AA_9E_E9_9F_B3_E5_82_B3_E8_A8_8A() {
  if ((_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('傳送'.toLowerCase())!=-1) && !(_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('不傳送'.toLowerCase())!=-1)) {
    var Line_E7_BE_A4_E7_B5_84_E6_AC_8A_E6_9D_96 = (spreadsheetsql_getData());
    var _E5_82_B3_E9_80_81_E6_96_87_E5_AD_97_E5_B0_8D_E8_B1_A1 = _E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.slice(0, (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.indexOf('傳送') + 1) - 1);
    var _E5_82_B3_E9_80_81_E6_96_87_E5_AD_97 = _E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.slice(((_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.indexOf('傳送') + 1 + '傳送'.length) - 1), _E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.length);
    var i_end3 = Line_E7_BE_A4_E7_B5_84_E6_AC_8A_E6_9D_96.length;
    var i_inc3 = 1;
    if (1 > i_end3) {
      i_inc3 = -i_inc3;
    }
    for (i = 1; i_inc3 >= 0 ? i <= i_end3 : i >= i_end3; i += i_inc3) {
      var _E6_9A_AB_E5_AD_98_E8_B3_87_E6_96_99 = Line_E7_BE_A4_E7_B5_84_E6_AC_8A_E6_9D_96[(i - 1)];
      if (_E6_9A_AB_E5_AD_98_E8_B3_87_E6_96_99[0] == _E5_82_B3_E9_80_81_E6_96_87_E5_AD_97_E5_B0_8D_E8_B1_A1) {
        linenotify_push_message((_E6_9A_AB_E5_AD_98_E8_B3_87_E6_96_99[1]),{'type':'text','text':_E5_82_B3_E9_80_81_E6_96_87_E5_AD_97});
        _E8_AA_9E_E9_9F_B3_E6_9C_97_E8_AE_80(_E6_9C_97_E8_AE_80_E8_AA_9E_E9_9F_B3, 'Line訊息已傳送');
      }
    }
  }
}

// 描述此函式...
async function _E6_9C_97_E8_AE_80_E6_9F_A5_E8_A9_A2_E8_B3_87_E6_96_99() {
  _E8_AA_9E_E9_9F_B3_E6_9C_97_E8_AE_80(_E6_9C_97_E8_AE_80_E8_AA_9E_E9_9F_B3, ['查到',spreadsheetsql_getDataCount("ROWS"),'筆資料'].join(''));
  while (ttsSpeaking()) {
    _E7_AD_89_E5_BE_85_E6_9C_97_E8_AE_80_E5_AE_8C_E6_88_90();

    await delay(0.01);
  }
  if (_E8_BE_A8_E8_AD_98_E7_B5_90_E6_9E_9C.toLowerCase().indexOf('近'.toLowerCase())!=-1) {
    _E8_AA_9E_E9_9F_B3_E6_9C_97_E8_AE_80(_E6_9C_97_E8_AE_80_E8_AA_9E_E9_9F_B3, String(spreadsheetsql_getCell(1, 1)) + String(spreadsheetsql_getCell(2, 1)));
    while (ttsSpeaking()) {
      _E7_AD_89_E5_BE_85_E6_9C_97_E8_AE_80_E5_AE_8C_E6_88_90();

      await delay(0.01);
    }
  }
}

// 描述此函式...
function _E7_AD_89_E5_BE_85_E6_9C_97_E8_AE_80_E5_AE_8C_E6_88_90() {
  if (Recognition_state()) {
    Recognition_switch(0);
  }
}


_E8_A8_82_E9_96_B1_E4_B8_BB_E9_A1_8C = 'osep/light';
_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C = 'osep/light';
span_create('',210,50,20,'',999);
const clientId = "mqtt_" + Math.random().toString(16).substr(2, 8);
const options = {
	username: '',
	password: '',
	keepalive: 60,
	clientId: clientId,
	protocolId: "MQTT",
	protocolVersion: 4,
	clean: true,
	reconnectPeriod: 1000,
	connectTimeout: 30 * 1000
}

var mqtt_client = mqtt.connect('wss://broker.hivemq.com:8884/mqtt',options);
mqtt_client.on("connect", ()=>{
	console.log("connected");
  mqtt_client.subscribe(_E8_A8_82_E9_96_B1_E4_B8_BB_E9_A1_8C);
	mqtt_client.on("message", async function (topic, payload) {
  if (topic==_E8_A8_82_E9_96_B1_E4_B8_BB_E9_A1_8C) {
    span_set('',"innerHTML",(new TextDecoder().decode(payload)));
    if ((new TextDecoder().decode(payload)) == 'on') {
      image_create('onpic','https://raw.githubusercontent.com/ntpcweyjan/ntpcweyjan.github.io/b4ccd4028ddc0fe4d4c02b4741303cd552b14bee/ON.svg',200,300,120,70,999,true);
      image_create('offpic','https://raw.githubusercontent.com/ntpcweyjan/ntpcweyjan.github.io/26ceeefae079cda53ebf58e76760b054f586e005/OFF.svg',200,300,120,70,999,false);
    }
    if ((new TextDecoder().decode(payload)) == 'off') {
      image_create('onpic','https://raw.githubusercontent.com/ntpcweyjan/ntpcweyjan.github.io/b4ccd4028ddc0fe4d4c02b4741303cd552b14bee/ON.svg',200,300,120,70,999,false);
      image_create('offpic','https://raw.githubusercontent.com/ntpcweyjan/ntpcweyjan.github.io/26ceeefae079cda53ebf58e76760b054f586e005/OFF.svg',200,300,120,70,999,true);
    }
    colorpicker_create('',200,300,120,70,1,'#000000',900,true);
  }
   })
  }
)

button_create('on',100,40,120,0,1,null,'開燈',12,999,true);
button_create('off',100,40,220,0,1,null,'關燈',12,999,true);
async function gamebutton_on_onclick (event) {
  mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String('on'));
};
document.getElementById("gamebutton_on").addEventListener("click", gamebutton_on_onclick, true);
async function gamebutton_off_onclick (event) {
  mqtt_client.publish(_E7_99_BC_E5_B8_83_E4_B8_BB_E9_A1_8C, String('off'));
};
document.getElementById("gamebutton_off").addEventListener("click", gamebutton_off_onclick, true);
};main();</script></body></html>